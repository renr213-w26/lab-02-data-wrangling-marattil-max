---
title: "Lab 2 - Data wrangling"
author: "Kathrine Marattil"
date: "Feb 10, 2026"
format: 
  html: default # for speed
  pdf: default # for final output
---

```{r}
#| eval: true
#| message: false

library(tidyverse)
```

# Questions

## Part 1

### Question 1

```{r}
midwest |>
 count(state)|>
  arrange(desc(n)) #arrange by number of counties

```

Illinois has the greatest amount of counties of 102, and Wisconsin has lowest amount of counties 72.

\newpage

### Question 2

```{r}

midwest |>
  count(county)|>
  filter(n ==5)
  
```

\newpage

### Question 3

```{r}
#a
popden <- midwest|>
  filter(popdensity > 25000)|>
  select(county, state, popdensity, poptotal, area)
popden
```

```{r}
#b
highest_popden <- midwest|>
  filter(popdensity == max(popdensity)) |>
  select(county, state, popdensity, poptotal, area)
highest_popden
```

\newpage

### Question 4

```{r}
midwest|>
  summarise(
    mean = mean(popdensity),
    Q1 = quantile(popdensity,0.25),
    Q3 = quantile(popdensity,0.75)
    )|>
  select(mean, Q1, Q3)

```

> The distribution of population density of counties is unimodal and extremely right-skewed. A typical Midwestern county has population density of `3097` people per unit area. The middle 50% of the counties have population densities between `622` to `2330` people per unit area.

\newpage

### Question 5

```{r}
midwest |>
  mutate(metro = if_else(inmetro == 1, "Yes", "No"))|>
  group_by(state)|>
  summarise(
    metro_pop = sum(metro == "Yes"),
    total_pop = n(),
    propor = metro_pop/total_pop
  )|>
  select(state,propor)
```

\newpage

### Question 6

```{r}
#a
a <- midwest|>
  filter ((percollege<10) & (percbelowpoverty >45))|>
  select (county,state, percbelowpoverty,percollege)
a
```

```{r}
#b
b<- midwest|>
  filter ((percollege > 40) & (percbelowpoverty <20))|>
  select (county,state, percbelowpoverty,percollege)
b
```

```{r}
#c
outliers<- midwest|>
  filter ((percollege > 40 & percbelowpoverty <20) |(percollege<10 & percbelowpoverty >45)) |>
  select (county,state, percbelowpoverty,percollege)|>
  arrange(county)
outliers
```

```{r}
#d
midwest <- midwest |>
  mutate(
    potential_outlier = if_else(county %in% pull(outliers, county),
      "Yes","No")
    )
midwest|>
  select(county, state, percbelowpoverty,percollege, potential_outlier )|>
  arrange(potential_outlier)


```

```{r}
#e
ggplot(midwest, aes(x = percollege, y = percbelowpoverty, colour = potential_outlier, shape = state )) +
  geom_point() +
  labs(
    title = "Population below the Poverty Line by Population with College Degree, by percentage",
    x = "Population with College Degree (%)",
    y = "Population below the Poverty Line (%)",
  )
```

\newpage

### Question 7

```{r}
#a
state_population <- midwest|>
  count(poptotal)
state_population
```

\newpage

### Question 8

\newpage

## Part 2

### Question 9
